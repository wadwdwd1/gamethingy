!function(){"use strict";var e=!1,n=500,o=Math.min(4,navigator.hardwareConcurrency||2),t=window.cr_opusWasmScriptUrl||"opus.wasm.js",r=0,i=[],u=[],l=0,a=[],c=!0,s=null,f=!1,d=null;function p(){e&&console.log.apply(console,arguments)}function w(n){e&&console.takeHeapSnapshot(n)}function h(){e&&console.profileEnd("audio")}function g(n){var i,u,l;0==r&&(r=1,c&&(p("Initialising multi-worker opus decoder"),e&&console.profile("audio"),w("init"),i=function(e,t){if(e)throw new Error(e);for(var i=n||o;i--;)b(t);r=2,m()},u=/(iphone|ipod|ipad)/i.test(navigator.userAgent),l=!!window.cordova,u&&l?d?i(null,d):y(t,(function(e,n){e?i(e):(d=URL.createObjectURL(new Blob(['self["IS_WKWEBVIEW"] = true;\n',n])),i(null,d))})):window.cr_opusWasmBinaryUrl?d?i(null,d):fetch(t).then((function(e){return e.text()})).then((function(e){var n='self["cr_opusWasmBinaryUrl"] = "'+window.cr_opusWasmBinaryUrl+'";\n';d=URL.createObjectURL(new Blob([n,e])),i(null,d)})).catch((function(e){i(e)})):i(null,t)))}function v(){if(2==r){p("Destroying opus decoder"),W();for(var n=0,o=a.length;n<o;n++)a[n].terminate();var t;r=0,i.length=0,u.length=0,l=0,a.length=0,w("destroy"),t=5e3,e&&setTimeout(h,t),function(n,o){e&&setTimeout(w,o,n)}("after completion",5e3)}}function m(){var e,n,o,t;if(c){var r=a.length;if(i.length)for(W();i.length;)t=(e=i.pop())[0],n=e[1],o=e[2],a[t%r].postMessage({id:t,buffer:n},[n]),u.push([t,o])}}function y(e,n){var o=window.cordova.file.applicationDirectory+"www/"+e;window.resolveLocalFileSystemURL(o,(function(e){e.file((function(e){var t=new FileReader;t.onload=function(){n(null,t.result)},t.onerror=function(){n("Failed to read "+o)},t.readAsArrayBuffer(e)}))}))}function b(e){var n=new Worker(e);a.push(n),n.onmessage=D}function U(e,o,t,r){for(var i,l=0,a=u.length;l<a;l++)if(u[l][0]==e){i=u[l],u.splice(l,1);break}if(!i)throw new Error("No job with ID "+e);i[1](o,t,r),0==u.length&&function(){if(f)return;s&&W();p("Starting idle timer"),w("idle"),s=setTimeout(B,n)}()}c&&(window.OpusDecoder=function(e,n){i.unshift([l++,e,n]),2==r?m():0==r&&g()},window.OpusDecoder.Initialise=function(e){f=!0,g(e)},window.OpusDecoder.Destroy=function(){v()},window.OpusDecoder.type="concurrent");var D=function(e){var n=e.data,o=n.id;switch(n.type){case"request":!function(e,n,o){y(e,(function(e,t){e?n.postMessage({type:"request",id:o,error:e}):n.postMessage({type:"request",id:o,buffer:t},[t])}))}(n.url,this,o);break;case"error":U(o,n.value,null);break;case"complete":U(o,null,n.value,n.time)}};function W(){s&&(p("Cancelling idle timer"),clearTimeout(s),s=null)}var B=function(){s&&(p("Completing idle timer"),s=null,v())}}();